# 슈퍼 틱택토 (Ultimate Tic-Tac-Toe)

## 개요

tkinter 기반의 GUI 슈퍼 틱택토 게임입니다. 9개의 작은 틱택토 보드로 구성된 큰 보드에서 진행되며, **강제 이동 규칙**이 적용되어 전략적 깊이가 더해진 고급 틱택토 게임입니다.

## 게임 규칙

### 기본 규칙
1. 9개의 작은 3×3 틱택토 보드가 3×3 격자로 배치됨
2. 작은 보드에서 승리하면 해당 보드를 차지
3. 큰 보드에서 가로, 세로, 또는 대각선으로 3개 보드를 먼저 차지하면 승리

### 강제 이동 규칙 (핵심)
- 내가 놓은 **셀의 위치**가 상대방이 다음에 플레이해야 할 **보드를 결정**
- 예: 보드 0의 셀 4에 두면 → 상대방은 반드시 보드 4에 두어야 함
- 지정된 보드가 이미 끝났다면(승리/무승부) → 자유 선택

```
보드 인덱스:          셀 인덱스 (각 보드 내):
 0 | 1 | 2            0 | 1 | 2
---|---|---          ---|---|---
 3 | 4 | 5            3 | 4 | 5
---|---|---          ---|---|---
 6 | 7 | 8            6 | 7 | 8
```

## 주요 기능

| 기능 | 설명 |
|------|------|
| 1인용 모드 | AI와 대전 |
| 2인용 모드 | 로컬 멀티플레이어 |
| 강제 이동 표시 | 금색 테두리로 다음 보드 강조 |
| 보드 승리 표시 | 승리한 보드에 큰 X/O 표시 |
| 색상 구분 | X(파랑), O(주황) 색상 적용 |

## 코드 구조

### 클래스 다이어그램

```
┌─────────────────────────────────────────┐
│              GameBoard                   │
├─────────────────────────────────────────┤
│ - small_boards: List[List[str]]         │
│ - board_winners: List[Optional[str]]    │
│ - next_board: Optional[int]             │
├─────────────────────────────────────────┤
│ + reset()                               │
│ + make_move(board_idx, cell_idx, player)│
│ + check_small_board_win(board_idx, ...)│
│ + check_game_win()                      │
│ + get_valid_boards()                    │
│ + get_valid_cells(board_idx)            │
└─────────────────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────┐
│           SuperTicTacToe                │
├─────────────────────────────────────────┤
│ - board: GameBoard                      │
│ - buttons: List[List[Button]]           │
│ - game_mode: int                        │
│ - current_player: str                   │
│ - game_over: bool                       │
├─────────────────────────────────────────┤
│ + create_menu()                         │
│ + start_game(mode)                      │
│ + create_board_ui()                     │
│ + on_cell_click(board_idx, cell_idx)    │
│ + ai_move()                             │
│ + update_board_ui()                     │
│ + handle_game_end(winner)               │
└─────────────────────────────────────────┘
```

---

## GameBoard 클래스

게임 로직을 담당하는 핵심 클래스입니다.

### 속성

| 속성 | 타입 | 설명 |
|------|------|------|
| `small_boards` | `List[List[str]]` | 9개 보드의 9개 셀 상태 |
| `board_winners` | `List[Optional[str]]` | 각 보드의 승자 (`None`, `'X'`, `'O'`, `'Draw'`) |
| `next_board` | `Optional[int]` | 다음 플레이어가 두어야 할 보드 (None = 자유 선택) |

### 주요 메서드

#### `reset()`
게임 상태를 초기화합니다.

#### `make_move(board_idx, cell_idx, player)`
플레이어의 수를 처리합니다.

**처리 순서:**
1. 이미 승부가 난 보드인지 확인
2. 이미 채워진 칸인지 확인
3. 강제 이동 규칙 확인
4. 수를 놓음
5. 작은 보드 승리 확인
6. 다음 플레이어가 갈 보드 설정

```python
# 다음 보드 결정 로직
if self.board_winners[cell_idx] is None:
    self.next_board = cell_idx  # 해당 보드로 강제
else:
    self.next_board = None  # 자유 선택
```

#### `check_small_board_win(board_idx, player)`
작은 보드에서 승리 여부를 확인합니다.

**검사 패턴:**
- 가로 3줄: `[0,1,2]`, `[3,4,5]`, `[6,7,8]`
- 세로 3줄: `[0,3,6]`, `[1,4,7]`, `[2,5,8]`
- 대각선 2줄: `[0,4,8]`, `[2,4,6]`

#### `check_game_win()`
전체 게임의 승리 조건을 확인합니다.

**반환값:**
- `'X'` 또는 `'O'`: 해당 플레이어 승리
- `'Draw'`: 무승부
- `None`: 게임 진행 중

#### `get_valid_boards()`
현재 플레이어가 수를 둘 수 있는 보드 목록을 반환합니다.

#### `get_valid_cells(board_idx)`
특정 보드에서 수를 둘 수 있는 셀 목록을 반환합니다.

---

## SuperTicTacToe 클래스

GUI 및 게임 상호작용을 관리하는 클래스입니다.

### UI 색상 설정

```python
player_colors = {'X': '#4A90E2', 'O': '#E2794A'}  # 플레이어 색상
default_color = '#F0F0F0'                          # 기본 셀 색상
highlight_color = '#FFFACD'                        # 강조 색상
won_board_color = {'X': '#B3D9FF', 'O': '#FFD4B3'} # 승리 보드 배경
```

### 주요 메서드

#### `create_menu()`
게임 모드 선택 메뉴를 생성합니다.

#### `create_board_ui()`
게임 보드 UI를 생성합니다.

**UI 구조:**
- 상태 라벨 (현재 차례 표시)
- 규칙 라벨 (강제 이동/자유 선택 표시)
- 9×9 버튼 그리드 (9개 프레임에 각 9개 버튼)
- 새 게임 버튼

#### `on_cell_click(board_idx, cell_idx)`
셀 클릭 이벤트를 처리합니다.

**처리 흐름:**
1. 게임 종료 여부 확인
2. 수 두기 시도
3. UI 업데이트
4. 승리 확인
5. 턴 변경
6. AI 턴 처리 (1인용 모드)

#### `ai_move()`
AI의 수를 결정합니다.

**AI 전략 (우선순위 순):**
1. **즉시 승리**: 전체 게임을 이길 수 있는 수 탐색
2. **방어**: 상대방이 전체 게임을 이기는 것 차단
3. **위치 선호**: 중앙(4) → 모서리(0,2,6,8) → 변(1,3,5,7)

```python
preference_order = [4, 0, 2, 6, 8, 1, 3, 5, 7]
```

#### `update_board_ui()`
보드 UI를 현재 게임 상태에 맞게 업데이트합니다.

**업데이트 내용:**
- 승리 보드: 큰 X/O 표시, 버튼 비활성화
- 무승부 보드: "무" 표시, 버튼 비활성화
- 진행 중 보드: 유효 보드 강조 (금색 테두리)

#### `handle_game_end(winner)`
게임 종료 시 결과를 처리합니다.

---

## 사용 방법

### 실행
```bash
python super_tictactoe.py
```

### 게임 플레이
1. 모드 선택 (1인용 또는 2인용)
2. 금색 테두리가 있는 보드의 빈 칸 클릭
3. 작은 보드에서 승리하면 해당 보드 차지
4. 큰 보드에서 3줄을 완성하면 승리

### UI 가이드

| 표시 | 의미 |
|------|------|
| 금색 테두리 | 수를 둘 수 있는 보드 |
| 파란색 X | 플레이어 X의 수 |
| 주황색 O | 플레이어 O의 수 |
| 큰 X/O | 해당 보드의 승자 |
| "무" | 해당 보드 무승부 |

---

## 의존성

- Python 3.x
- `tkinter` (표준 라이브러리)
- `random` (표준 라이브러리)

---

## 개선 가능 사항

1. **미니맥스 + 알파-베타 가지치기**: 더 강력한 AI 구현
2. **온라인 멀티플레이어**: 네트워크 대전 기능
3. **애니메이션 효과**: 수를 놓을 때 시각적 피드백
4. **사운드 효과**: 클릭, 승리 등 효과음 추가
5. **난이도 선택**: AI 강도 조절 옵션
6. **게임 저장/불러오기**: 진행 중인 게임 저장

---

## 파일 정보

| 항목 | 내용 |
|------|------|
| 파일명 | `super_tictactoe.py` |
| 언어 | Python 3 |
| UI | GUI (tkinter) |
| 라인 수 | 약 450줄 |
| 클래스 수 | 2개 (`GameBoard`, `SuperTicTacToe`) |
